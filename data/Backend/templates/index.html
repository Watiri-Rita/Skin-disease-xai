<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Skin Disease Classifier</title>
<style>
body { font-family: Arial, sans-serif; }
img { border: 1px solid #ccc; margin: 10px; max-width: 300px; height: auto; }
.container { display: flex; flex-direction: row; align-items: flex-start; }
#loading { display: none; font-weight: bold; color: blue; }
#error { color: red; font-weight: bold; }
</style>
</head>
<body>
<h1>Skin Disease Classifier</h1>

<form id="upload-form">
<input type="file" id="file-input" accept="image/*" required>
<button type="submit">Predict</button>
</form>

<p id="loading">ðŸ”„ Predicting... please wait</p>
<p id="error"></p>

<h2>Prediction:</h2>
<p id="prediction"></p>
<p id="confidence"></p>

<h2>Images:</h2>
<div class="container">
    <div>
        <p>Original Image</p>
        <img id="original-img" src="" alt="Original image">
    </div>
    <div>
        <p>Grad-CAM Overlay</p>
        <img id="gradcam-img" src="" alt="Grad-CAM overlay">
    </div>
</div>

<script>
document.getElementById("upload-form").addEventListener("submit", async (e)=>{
    e.preventDefault();
    const fileInput = document.getElementById("file-input");
    const file = fileInput.files[0];
    if(!file) return;

    document.getElementById("error").innerText = "";
    document.getElementById("prediction").innerText = "";
    document.getElementById("confidence").innerText = "";
    document.getElementById("original-img").src = "";
    document.getElementById("gradcam-img").src = "";

    document.getElementById("loading").style.display = "block";

    const formData = new FormData();
    formData.append("file", file);

    try {
        const response = await fetch("/predict", {method:"POST", body:formData});
        const data = await response.json();

        if(response.ok){
            document.getElementById("prediction").innerText = "Label: " + data.prediction;
            document.getElementById("confidence").innerText = "Confidence: " + data.confidence;

            if(data.original_base64){
                document.getElementById("original-img").src = data.original_base64;
            }
            if(data.gradcam_base64){
                document.getElementById("gradcam-img").src = data.gradcam_base64;
            } else {
                document.getElementById("gradcam-img").alt = "Grad-CAM not generated";
            }
        } else {
            document.getElementById("error").innerText = data.error || "Prediction failed";
        }
    } catch(err){
        console.error(err);
        document.getElementById("error").innerText = "An error occurred. Check console for details.";
    } finally {
        document.getElementById("loading").style.display = "none";
    }
});
</script>
</body>
</html>
